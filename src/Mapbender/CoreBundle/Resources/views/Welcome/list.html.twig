{% extends "MapbenderManagerBundle::manager.html.twig" %}

{% block title %}{{ "mb.manager.admin.applications" | trans }}{% endblock %}

{% block js %}
  {{parent()}}
  <script type="text/javascript" src="{{ asset('bundles/mapbendermanager/js/application-list.js') }}"></script>
{% endblock %}

{% block manager_content %}

  {# {% include "MapbenderManagerBundle:Application:actions.html.twig" %} #}
  {% if applications | length > 0 %}

		<div class="container pull-left filter-input-container">
			<label for="inputFilterApplications" class="col-md-3 labelInput">{{ "mb.actions.filter" | trans}}</label>
			<input id="inputFilterApplications" type="text" class="input col-md-7 listFilterInput">
			<span class="iconSearch col-md-2"></span>
		</div>

    <ul id="listFilterApplications" class="container-fluid listFilterContainer clear listFilterBoxes listFilterApplicationBoxes">
      {% for application in applications %}
        <li class="filterItem">
          <a target="_blank" href="{{ path('mapbender_core_application_application', {'slug': application.slug}) }}" title="{{ 'mb.manager.admin.application.view' | trans }} {{ application.title }}">
            <div class="col-md-2 col-xs-12">
              <div class="cell">
              {% if application.screenshot is not null %}
                  <img src="{{ uploads_web_url }}/{{application.slug}}/{{application.screenshot}}?t={% if time != null %}{{ time | date('d.m.Y-H:i:s') }}{% endif %}">
              {% else %}
                  <span class="iconAppDefault"></span>
              {% endif %}
              </div>
            </div>
          </a>
          <div class="col-md-10 col-sm-12">
            <a href="{{ path('mapbender_core_application_application', {'slug': application.slug}) }}" class="title" title="{{ 'mb.manager.admin.application.view_this' | trans }}">
                {{ application.title }}
            </a>
            <p>
                <b>URL Title:</b>
                {{ application.slug }}
            </p>
            <p>
                <b>Descriptions:</b>
                {{ application.description }}
            </p>

            <p class="buttonGroup">
              <button class="btn btn-default btn-app-list">
                <a class="iconView hover-highlight-effect" target="_blank" href="{{ path('mapbender_core_application_application', {'slug': application.slug}) }}" title="{{ 'mb.manager.admin.application.view' | trans }} {{ application.title }}"></a>
              </button>
              {% if is_granted('EDIT', application) %}
              <button class="btn btn-default btn-app-list">
                <a class="iconCopy hover-highlight-effect" href="{{ path('mapbender_manager_application_copydirectly', {'slug': application.slug}) }}" title="{{ 'mb.manager.admin.application.duplicate'|trans }} {{ application.title }}"></a>
              </button>
              {% endif %}

              {% if application.source is constant('Mapbender\\CoreBundle\\Entity\\Application::SOURCE_DB') and is_granted('EDIT', application) %}
              <button class="btn btn-default btn-app-list">
                <a class="iconEdit hover-highlight-effect" href="{{ path('mapbender_manager_application_edit',  {'slug': application.slug}) }}" title="{{ 'mb.manager.admin.application.edit.title' | trans }} {{ application.title }}"></a>
              </button>
              {% endif %}

              {% if application.source is constant('Mapbender\\CoreBundle\\Entity\\Application::SOURCE_DB') and is_granted('EDIT', application) %}
              <button class="btn btn-default btn-app-list">
                <a href="#" class="{{ application.published ? 'iconPublishActive' : 'iconPublish disabled' }} hover-highlight-effect" title="{{ 'mb.manager.admin.application.public.on_off' | trans }} {{ application.title }}"
                   data-url="{{ path('mapbender_manager_application_togglestate', {'slug': application.slug}) }}"></a>
              </button>
              {% endif %}

              {% if application.source is constant('Mapbender\\CoreBundle\\Entity\\Application::SOURCE_DB') and is_granted('DELETE', application) %}
              <button class="btn btn-default btn-app-list">
                <span class="iconRemove hover-highlight-effect"
                      title="{{'mb.manager.admin.application.delete'|trans}} {{ application.title }}"
                      data-url="{{ path('mapbender_manager_application_delete', { 'slug': application.slug}) }}"
                      data-slug="{{ application.slug }}"
                ></span>
              </button>
              {% endif %}
            </p>
          </div>

        </li>
      {% endfor %}
    </ul>
    <div class="clearContainer"></div>
  {% else %}
    <span class="description">{{ 'mb.manager.admin.application.no_application' | trans }}</span>
  {% endif %}
  <div class="clearContainer"></div>

{% endblock %}
